# 21 事务隔离机制

```python
# 【一】数据库读现象的本质
# ● 是数据库在高并发场景下
# ● 多个同时执行的事务带来的影响。
# 【二】数据库三大读现象
# ● 在数据库中，不同的事务隔离级别可能会导致脏读（Dirty Read）、不可重复读（Non-repeatable Read）和幻读（Phantom Read）等问题的出现。

# 1.脏读
# ● 事务1和事务2并发执行
# ● 事务1改了数据
# ● 事务2读取了以后
# ● 但事务1进行了回滚
# ● 导致事务2读取的数据有误。

# ● 脏读指的是读当前事务到了其他事务未提交的数据，未提交意味着这些数据可能会回滚，
# ● 也就是可能最终不会存到数据库中，也就是不存在的数据。读到了并一定最终存在的数据，这就是脏读

# 2.不可重复读
# ● 事务1读取了数据
# ● 事务2修改了数据并且提交了
# ● 接着事务1再次读取
# ● 发现两次的数据不相同

# ● 解释：不可重复读指的是在一个事务内，最开始读到的数据和事务结束前的任意时刻读到的同一批数据出现不一致的情况
# ● 导致的原因：事务 A 多次读取同一数据，但事务 B 在事务A多次读取的过程中，对数据作了更新并提交，导致事务A多次读取同一数据时，结果 不一致

# 3.幻读
# ● 幻读的本质在于某一次select操作得到的结果无法支撑后续的业务操作。
# ● 具体来说，例如在执行select判断某条记录是否存在时，假设该记录不存在，准备插入该记录，但在执行insert时却发现该记录已经存在，导致无法插入，这即是幻读的发生。

# 【三】数据库事务隔离机制
# ● 事务具有原子性、一致性、隔离性、持久性四大特性
# [1]Read uncommitted（读未提交）
# ● 最低的隔离级别，在这个级别下，一个事务可以读取到另一个事务尚未提交的数据，可能导致脏读（Dirty Read）问题，即读取到未经验证的数据。
# [2]Read committed（读已提交）
# ● 在这个级别下，一个事务只能读取到已经提交的数据，避免了脏读问题。
# ● 但是可能会出现不可重复读（Non-repeatable Read）问题，即同一事务中，两次读取相同的记录可能得到不同的结果，因为其他事务修改了这些记录。
# [3]Repeatable read（可重复读取）
# ● 在这个级别下，事务开始读取数据后，其他事务无法修改这些数据，保证了同一个事务内两次读取相同记录的一致性。
# ● 但是可能会出现幻读（Phantom Read）问题，即同一查询在同一事务中两次执行可能返回不同的结果，因为其他事务插入或删除了符合查询条件的记录。
# [4]Serializable（串行化）
# ● 最高级别的隔离级别，要求事务串行执行，事务之间完全隔离，避免了脏读、不可重复读和幻读问题。
# ● 但是这会牺牲并发性能，因为并发事务被限制为顺序执行。
```

