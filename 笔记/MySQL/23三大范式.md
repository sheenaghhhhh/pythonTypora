# 23 三大范式

```python
# 【什么是范式】
# ● 范式就是我们在设置数据库的表时，一些共同需要遵守的规范
# ● 掌握这些设计时的范式，可以让我们在项目之初，设计库的表结构更加合理和优雅
# 【三大范式之间的关系】
# ● 三大范式之间，是逐级递进的关系，也就是说后一个范式是在前一个范式的基础上推行。
# ● 我们举一个形象的例子来说
#   ○ 我们吃饭的时候
#   ○ 第一步是买菜
#   ○ 第二步是炒菜
#   ○ 第三步才是吃菜
# ● 这三者之间不能颠倒，后者都是建立在前者之上的，顺序不能颠倒。

# 什么是第一范式
# ● 表库设计时，主要是为了确保原子性，也就是存储的数据具有不可再分性。
# ● 注意
#   ○ 这里的原子性不等同于MySQL特点中的原子性
# ● MySQL特性之原子性
#   ○ 指事务是操作数据库的基本单位，要么全部执行成功，要么全部失败回滚
#   ○ 这样做确保了数据库在任何情况下都能保持一致的状态，不会出现中间数据
# ● 第一范式的原子性
#   ○ 指一个字段不可再分割，其中不能包含其他更小的数据单元
#   ○ 也就是说，一个字段的数据不能再被进一步分解为更小的数据单元
# ● 为了更好的理解上述所说的原子性，我们以一个例子来说明
'''
+----------------------+--------+-------+
| student              | course | score |
+----------------------+--------+-------+
| 蚩梦，男，185cm      | 语文   |    95 |
| 蚩梦，男，185cm      | 数学   |   100 |
| 蚩梦，男，185cm      | 英语   |    88 |
| 萌萌，女，170cm      | 语文   |    99 |
| 萌萌，女，170cm      | 数学   |    90 |
| 萌萌，女，170cm      | 英语   |    95 |
+----------------------+--------+-------+
'''

# 按照第一范式的要求 ： 每个字段不可在分割
'''
+--------------+-------------+----------------+--------+-------+
| student_name | student_sex | student_height | course | score |
+--------------+-------------+----------------+--------+-------+
| 蚩梦         | 男          | 185cm          | 语文   |    95 |
| 蚩梦         | 男          | 185cm          | 数学   |   100 |
| 蚩梦         | 男          | 185cm          | 英语   |    88 |
| 萌萌         | 女          | 170cm          | 语文   |    99 |
| 萌萌         | 女          | 170cm          | 数学   |    90 |
| 萌萌         | 女          | 170cm          | 英语   |    95 |
+--------------+-------------+----------------+--------+-------+
'''
# 1.第一范式(1NF)小结
# ● 第一范式，我们通常也叫 1NF
# ● 第一范式要求我们必须遵守原子性
#   ○ 即数据库表的每一列都是不可分割
#     ■ 每列的值具有原子性，不可再分割
#     ■ 每个字段的值都只能是单一值

# 什么是第二范式
# ● 首先第二范式是在满足第一范式的基础上
#   ○ 第一范式我们已经能够理解了，那么我们再来看看第二范式
# ● 第二范式要求表中的所有列，其数据依赖于主键
#   ○ 即一张表只存储同一类型的数据，不能有任何一列数据与主键没有关系
'''
+--------------+-------------+----------------+
id| student_name | student_sex | student_height | 
+--------------+-------------+----------------+
1| 蚩梦         | 男          | 185cm          |
2| 蚩梦         | 男          | 185cm          |
3| 蚩梦         | 男          | 185cm          |
4| 萌萌         | 女          | 170cm          |
5| 萌萌         | 女          | 170cm          |
6| 萌萌         | 女          | 170cm          |
+--------------+-------------+----------------+
'''

'''
+-----------+-------------+
| course_id | course_name |
+-----------+-------------+
|         1 | 语文        |
|         2 | 数学        |
|         3 | 英语        |
+-----------+-------------+
'''

'''
+----------+------------+-----------+-------+
| id | student_id | course_id | score |
+----------+------------+-----------+-------+
|        1 |          1 |         1 |    95 |
|        2 |          1 |         2 |   100 |
|        3 |          1 |         3 |    88 |
|        4 |          2 |         1 |    99 |
|        5 |          2 |         2 |    90 |
|        6 |          2 |         3 |    95 |
+----------+------------+-----------+-------+
'''
# 2.第二范式(2NF)小结
# ● 第二范式，我们通常也叫 2NF
#   ○ 第二范式(2NF)是在第一范式(1NF)的基础上建立起来得
#   ○ 满足第二范式(2NF)必须先满足第一范式(1NF)
# ● 第一范式要求我们必须遵守原子性
# ● 第二范式要求表中的所有列，其数据依赖于主键
#   ○ 即一张表只存储同一类型的数据，不能有任何一列数据与主键没有关系
#     ■ 如果表是单主键，那么主键以外的列必须完全依赖于主键，其它列需要跟主键有关系
#     ■ 如果表是复合主键，那么主键以外的列必须完全依赖于主键，不能仅依赖主键的一部分

# 第三范式
# 什么是第三范式
# ● 首先第三范式是在满足第二范式的基础上
#   ○ 第二范式我们已经能够理解了，那么我们再来看看第三范式
# ● 第三范式要求表中每一列数据不能与主键之外的字段有直接关系
#   ○ 表中的非主键列必须和主键直接相关而不能间接相关
#   ○ 非主键列之间不能相关依赖，不存在传递依赖

'''
+------------+--------+------+--------+--------------+--------------+
| student_id | name   | sex  | height | department   | dean         |
+------------+--------+------+--------+--------------+--------------+
|          1 | 蚩梦   | 男   | 185cm  | 计算机系     | 竹子老大     |
|          2 | 萌萌   | 女   | 170cm  | 金融系       | 熊猫老大     |
|          3 | 萌     | 女   | 170cm  | 金融系       | 熊猫老大     |
+------------+--------+------+--------+--------------+--------------+
'''

'''
+------------+--------+------+--------+---------------+
| student_id | name   | sex  | height | department_id |
+------------+--------+------+--------+---------------+
|          1 | 蚩梦   | 男   | 185cm  |             1 |
|          2 | 萌萌   | 女   | 170cm  |             2 |
+------------+--------+------+--------+---------------+
'''
'''
+---------------+-----------------+-----------------+
| department_id | department_name | department_dean |
+---------------+-----------------+-----------------+
|             1 | 计算机系        | 竹子老大        |
|             2 | 金融系          | 熊猫老大        |
+---------------+-----------------+-----------------+
'''

# 3.第三范式(3NF)小结
# ● 第三范式，我们通常也叫 3NF
#   ○ 第三范式(3NF)是在第二范式(2NF)的基础上建立起来得
#   ○ 满足第三范式(3NF)必须先满足第二范式(2NF)
# ● 第一范式要求我们必须遵守原子性
# ● 第二范式要求表中的所有列，其数据依赖于主键
#   ○ 即一张表只存储同一类型的数据，不能有任何一列数据与主键没有关系
#     ■ 如果表是单主键，那么主键以外的列必须完全依赖于主键，其它列需要跟主键有关系
#     ■ 如果表是复合主键，那么主键以外的列必须完全依赖于主键，不能仅依赖主键的一部分
# ● 第三范式要求表中每一列数据不能与主键之外的字段有直接关系
#   ○ 表中的非主键列必须和主键直接相关而不能间接相关
#   ○ 非主键列之间不能相关依赖，不存在传递依赖


# 【数据库三范式小结】
# ● 到这里就已经将库表设计的三范式做了直观阐述，总结如下：
#   ○ 第一范式：确保原子性，表中每一个列数据都必须是不可再分的字段。
#   ○ 第二范式：确保唯一性，每张表都只描述一种业务属性，一张表只描述一件事。
#   ○ 第三范式：确保独立性，表中除主键外，每个字段之间不存在任何依赖，都是独立的。
# ● 经过三范式的示例后，数据库中的表数量也逐渐多了起来，似乎设计符合三范式的库表结构，反而更加麻烦了对吗？
# ● 答案并非如此，因为在没有按照范式设计时，会存在几个问题：
#   ○ 整张表数据比较冗余，同一个学生信息会出现多条。
#   ○ 表结构特别臃肿，不易于操作，要新增一个学生信息时，需添加大量数据。
#   ○ 需要更新其他业务属性的数据时，比如院系院长换人了，需要修改所有学生的记录。
# ● 但按照三范式将表结构拆开后
#   ○ 假设要新增一条学生数据，就只需要插入学生相关的信息即可
#   ○ 同时如果某个院系的院长换人了，只需要修改院系表中的院长就行，学生表中的数据无需发生任何更改。
# ● 经过三范式的设计优化后，整个库中的所有表结构，会显得更为优雅，灵活性也会更强
```

